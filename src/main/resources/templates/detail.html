<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title th:text="${glasses.name}"></title>
<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">

<!-- FONT GOOGLE -->
<link rel="preconnect" href="https://fonts.gstatic.com">
<link
	href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;700&display=swap"
	rel="stylesheet">

<!-- FONT AWESOME -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
	integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
	crossorigin="anonymous" />

<!-- OWL CAROUSEL -->
<link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}">
<link rel="stylesheet" th:href="@{/css/owl.theme.default.min.css}">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<!-- MAIN CSS -->
<link rel="stylesheet" th:href="@{/css/index.css}">
<link rel="stylesheet" th:href="@{/css/chitiet.css}">
<link rel="stylesheet" th:href="@{/css/sweetalert2.min.css}">

<STYLE>
@import
	url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css")
	;

.success-notification-container {
	position: fixed;
	top: 20px;
	right: 20px;
	z-index: 1050;
	max-width: 350px;
}

.success-alert {
	margin-bottom: 10px;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	background-color: #d4edda;
	color: #155724;
}
</STYLE>
</head>
<body>
	<header>
		<nav class="myNavBar navbar navbar-expand-lg navbar-light">
			<div class="col-7 myNavBar__col">
				<div class="myNavBar__left">
					<form class="myNavBar__form-search" th:action="@{/products/search}"
						method="get">
						<div class="input-group">
							<input type="text" class="form-control" name="keyword"
								placeholder="Search for anything">
							<div class="input-group-append">
								<span class="input-group-text" id="basic-addon2"
									style="padding: 0px">
									<button class="btn" type="submit">
										<i class="fa fa-search"></i>
									</button>

								</span>
							</div>
						</div>
					</form>
				</div>
			</div>
			<div class="col-5">
				<div class="myNavBar__right">
					<ul class="navbar-nav mr-auto">
						<p class="mt-2">Save 15% on two or more Rx pairs.</p>
						<li class="nav-item"><a class="nav-link" href="#">Learn
								more.</a></li>
						<li class="nav-item myNavBar__cart" style="position: relative;">
							<a class="nav-link" th:href="@{/cart?redirectTo=/home}"><i
								class="fa fa-shopping-cart"></i></a> <span
							style="position: absolute; left: 80%; top: 0;"
							class="soluong_cart"
							th:text="${cartQuantity > 0 ? cartQuantity : ''}"></span>
						</li>
						<li
							class="nav-item myNavBar__buttons d-flex justify-content-between">
							<div th:if="${session.username == null}"
								class="d-flex justify-content-between">
								<a class="nav-link" th:href="@{/login}">
									<button class="button button--white">Log In</button>
								</a> <a class="nav-link" th:href="@{/register}">
									<button class="button button--red">Sign Up</button>
								</a>
							</div>
							<div th:if="${session.username != null}">
								<a class="nav-link dropdown-toggle" href="#"
									id="navbarDropdownMenuLink" role="button"
									data-toggle="dropdown" aria-haspopup="true"
									aria-expanded="false"> <img
									th:src="@{/images/avatar/Avatar64.png}" alt="Avatar"
									class="user-avatar" style="width: 32px; height: 32px" /> <span
									th:text="${session.fullname}"></span>
								</a>

								<div class="dropdown-menu" style="left: -100px"
									aria-labelledby="navbarDropdownMenuLink">
									<a class="dropdown-item" th:href="@{/profile}">Xem thông
										tin cá nhân</a> <a class="dropdown-item"
										th:href="@{/changePassword}">Đổi mật khẩu</a> <a
										class="dropdown-item" th:href="@{/orderHistory}">Lịch sử
										mua hàng</a> <a class="dropdown-item" th:href="@{/logout}">Đăng
										xuất</a>
								</div>
							</div>

						</li>
					</ul>
				</div>
			</div>
		</nav>
		<nav class="navInstruction navbar navbar-expand-md">
			<a class="navbar-brand text-center" th:href="@{/home}">
				<p class="font-weight-bold mb-0">
					<i class="fa fa-glasses"></i>Eyeglasses
				</p>
				<p class="mb-0">Shop frames below, or find five to try for free.</p>
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarInstruction" aria-controls="navbarNavDropdown"
				aria-expanded="false" aria-label="Toggle navigation">
				<i class="fa fa-bars"></i>
			</button>
			<div class="collapse navbar-collapse" id="navbarInstruction">
				<ul class="navbar-nav ml-auto" id="mainNav">
					<li class="nav-item active"><a class="nav-link"
						th:href="@{/home}">Home</a></li>
					<li class="nav-item dropdown"><a
						class="nav-link dropdown-toggle" href="#"
						id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
						aria-haspopup="true" aria-expanded="false"> Eyeglasses </a>
						<div class="dropdown-menu"
							aria-labelledby="navbarDropdownMenuLink">
							<a class="dropdown-item" th:href="@{/products/eyeglasses/men}">Men's
								Eyeglasses</a> <a class="dropdown-item"
								th:href="@{/products/eyeglasses/women}">Women Eyeglasses</a>
						</div></li>
					<li class="nav-item dropdown"><a
						class="nav-link dropdown-toggle" href="#"
						id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
						aria-haspopup="true" aria-expanded="false"> Sunglasses </a>
						<div class="dropdown-menu"
							aria-labelledby="navbarDropdownMenuLink">
							<a class="dropdown-item" th:href="@{/products/sunglasses/men}">Men's
								Sunglasses</a> <a class="dropdown-item"
								th:href="@{/products/sunglasses/women}">Women's Sunglasses</a>
						</div></li>
					<li class="nav-item"><a class="nav-link" th:href="@{/about}">About</a></li>
					<!-- <li class="nav-item">
                        <a class="nav-link" href="#">Accessories</a>
                    </li> -->
					<li class="nav-item"><a class="nav-link" th:href="@{/chatbot}"><i
							class="fas fa-comments"></i>virtual assistant</a>
					<li class="nav-item"><a class="nav-link" th:href="@{/contact}">Contacts</a>
					</li>
				</ul>
			</div>
		</nav>
	</header>
	<!-- Container thông báo thành công sẽ được xử lý bằng SweetAlert2 bên dưới -->
	<!-- Container thông báo lỗi -->
	<div th:if="${error}"
		class="alert alert-danger alert-dismissible fade show" role="alert">
		<i class="fas fa-exclamation-circle me-2"></i> <span
			th:text="${error}"></span>
	</div>
	<div class="pro_detail" id="pro_detail" th:data-id="${glasses.id}"
		th:data-name="${glasses.name}" th:data-price="${glasses.price}"
		th:data-image="${glasses.imageSideUrl}"
		th:data-colorCode="${glasses.colorCode}"
		th:data-colorName="${glasses.colorName}">
		<section class="row">
			<div class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1"></div>
			<div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 chitiet1">
				<div id="demo" class="carousel slide" data-ride="carousel">
					<!-- Indicators -->
					<ul class="carousel-indicators">
						<li data-target="#demo" data-slide-to="0" class="active"></li>
						<li data-target="#demo" data-slide-to="1"></li>

					</ul>
					<!-- The slideshow -->
					<div class="carousel-inner section1">
						<div class="carousel-item active">
							<img th:src="@{${glasses.imageSideUrl}}" alt=""
								style="width: 100%;" id="selectedImageFront">
						</div>
						<div class="carousel-item">
							<img th:src="@{${glasses.imageFrontUrl}}" alt=""
								style="width: 100%;" id="selectedImageSide">
						</div>
					</div>
					<a class="carousel-control-prev" href="#demo" data-slide="prev"
						style="background-color: rgba(0, 0, 0, 0.5); width: 50px; height: 50px; border-radius: 50%; top: 50%; transform: translateY(-50%); margin-left: 10px;">
						<span class="carousel-control-prev-icon"></span>
					</a> <a class="carousel-control-next" href="#demo" data-slide="next"
						style="background-color: rgba(0, 0, 0, 0.5); width: 50px; height: 50px; border-radius: 50%; top: 50%; transform: translateY(-50%); margin-right: 10px;">
						<span class="carousel-control-next-icon"></span>
					</a>
				</div>
				<div class="color-options" style = "height: 0px;"
					th:title="${glasses.colorName}">
					<div class="color-option"
						th:style="'background-color: ' + ${glasses.colorCode}"
						th:data-image-front="@{${glasses.imageFrontUrl}}"
						th:data-image-side="@{${glasses.imageSideUrl}}"></div>
					<div class="color-name" th:text="${glasses.colorName}"
						style="text-align: center; margin-top: 0px; font-size: 16px; font-weight: 700">
					</div>
				</div>
			</div>
			<div class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4 chitiet2">
				<div class="mt-3 ml-2">
					<p style="font-weight: bold; font-size: 30px;"
						th:text="${glasses.name}"></p>
					<p th:text="${glasses.brand}"></p>
				</div>
				<hr>
				<!--  
				<div>
					<p style="font-weight: bold; font-size: 20px;">Medium</p>
				</div>-->
				<div class="row">
					<div class="col-6 display-4 text-center"
						style="line-height: 200px;">
						<p
							th:text="${T(iuh.fit.se.utils.Utils).formatPrice(glasses.price)}"></p>
					</div>
					<div class="col-6">
						<p style="font-size: 35px;">
							ZENNI <b>WOW PRICE</b> INCLUDES:
						</p>
						<p style="font-size: 18px;">
							<i class="bi bi-check"></i> High-quality frame
						</p>
						<p style="font-size: 18px;">
							<i class="bi bi-check"></i> Basic prescription lenses*
						</p>
						<p style="font-size: 18px;">
							<i class="bi bi-check"></i> Anti-scratch coating
						</p>
						<p style="font-size: 18px;">
							<i class="bi bi-check"></i> UV protection
						</p>
						<p>*does not include multifocal or readers options</p>
					</div>
				</div>
				<div class="row ml-3 mt-4">
					<label for="" class="col-11 ">
						<p style="font-size: 20px;">Add 0đ for rush delivery in 3-5
							business days</p>
						<p style="font-size: 18px;">*Only available for Single Vision,
							Progressive & Non-Prescription.</p>
					</label>
				</div>
				<div class="row">
						<form id="add-to-cart-form" th:action="@{/cart/add}" method="post" style="width: 100%">
							<input type="hidden" name="productId" th:value="${glasses.id}" />
							<input type="hidden" name="quantity" value="1" />
							<button type="button" id="add-to-cart-btn" th:disabled="${glasses.stock == 0}"
								th:class="${glasses.stock == 0 ? 'col-12 btn btn-secondary' : 'col-12 btn btn-info'}"
								style="font-size: 20px;">
								<i class="bi bi-cart"></i> <span
									th:text="${glasses.stock == 0 ? 'OUT OF STOCK' : 'ADD TO CART'}"></span>
							</button>
						</form>
					</div>
			</div>
			<div class="col-1 col-sm-1 col-md-1 col-lg-1 col-xl-1"></div>
		</section>
	</div>
	<hr>
	<div class="ml-4">
		<h1 class="display-5 font-weight-bold">Detail</h1>
		<div class="row mt-4">
			<div class="col-6 row">
				<div class="col-12 font-weight-bold" style="font-size: 20px;">SPECIFICATIONS</div>
				<div class="col-6 mt-3"
					style="font-size: 20px; color: rgb(123, 123, 123);">
					<p
						th:text="'PD Range: ' + ${glasses.specifications.pdRange} +' mm'"></p>
					<p
						th:text="'Prescription Range: ' + ${glasses.specifications.prescriptionRange}"></p>
					<p
						th:text="'Available as Progressive / Bifocal: ' + (${glasses.specifications.availableAsProgressiveBifocal}? 'Yes':'No')"></p>
					<p
						th:text="'Readers: ' + (${glasses.specifications.readers}? 'Yes':'No')"></p>
					<p
						th:text="'Frame size: '+ ${glasses.specifications.frameSizeDescription}"></p>
				</div>
				<div class="col-6 mt-3"
					style="font-size: 20px; color: rgb(123, 123, 123);">
					<p th:text="'Rim: ' + ${glasses.specifications.rim}"></p>
					<p th:text="'Shape: ' + ${glasses.specifications.shape}"></p>
					<p th:text="'Material: ' + ${glasses.specifications.material}"></p>
					<p th:text="'Feature: ' + ${glasses.specifications.feature}"></p>
				</div>
			</div>
			<div class="col-6 row">
				<div class="col-12 font-weight-bold" style="font-size: 20px;">FRAME
					SIZE</div>
				<div class="col-6"
					style="font-size: 20px; color: rgb(123, 123, 123);">
					<p
						th:text="'Frame Width: ' + ${glasses.frameSize.frameWidth} + ' mm'"></p>
					<p
						th:text="'Lens Width: ' + ${glasses.frameSize.lensWidth} + ' mm'"></p>
					<p th:text="'Bridge: ' + ${glasses.frameSize.bridge} + ' mm'"></p>
				</div>
				<div class="col-6"
					style="font-size: 20px; color: rgb(123, 123, 123);">
					<p
						th:text="'Temple Length: ' + ${glasses.frameSize.templeLength} + ' mm'"></p>
					<p
						th:text="'Lens Height: ' + ${glasses.frameSize.lensHeight} + ' mm'"></p>
					<p
						th:text="'Frame Weight: ' + ${glasses.frameSize.frameWeight} + ' mm'"></p>
				</div>
			</div>
		</div>
		<hr>
		<div class="mb-5">
			<h1 class="display-5 font-weight-bold">Description</h1>
			<div style="font-size: 20px; color: rgb(123, 123, 123);">
				.
				<p th:text="${glasses.description}"></p>
			</div>
		</div>
		<hr>
			<div class="container mt-5">
			<h1 class="display-4 text-center mb-5">Đánh giá sản phẩm</h1>
			
			<!-- Review Summary Section -->
			<div class="row mb-4">
				<div class="col-md-4 text-center">
					<div class="average-rating p-3 bg-light rounded shadow-sm">
						<h2 class="display-3 font-weight-bold mb-0" th:if="${averageRating != null}" th:text="${#numbers.formatDecimal(averageRating, 1, 1)}">4.5</h2>
						<h2 class="display-3 font-weight-bold mb-0" th:if="${averageRating == null}">0.0</h2>
						<div class="stars my-2" style="font-size: 24px; color: #ffc107;">
							<i th:each="i : ${#numbers.sequence(1, 5)}" 
							   th:class="${averageRating != null && i <= averageRating ? 'bi bi-star-fill' : (averageRating != null && i <= averageRating + 0.5 ? 'bi bi-star-half' : 'bi bi-star')}" 
							   style="margin-right: 2px;"></i>
						</div>
						<p class="text-muted" th:text="${reviewCount} + ' đánh giá'">0 đánh giá</p>
					</div>
				</div>
				
				<div class="col-md-8">
					<div class="rating-breakdown">
						<div class="d-flex align-items-center mb-2" th:each="i : ${#numbers.sequence(5, 1)}">
							<div class="mr-2" style="width: 30px;">
								<span th:text="${i}">5</span> <i class="bi bi-star-fill text-warning"></i>
							</div>
							<div class="progress flex-grow-1" style="height: 10px;">
								<div class="progress-bar bg-warning" role="progressbar" 
									th:style="'width: ' + ${ratingCounts != null && ratingCounts.containsKey(i) ? (ratingCounts.get(i) * 100 / (reviewCount > 0 ? reviewCount : 1)) : 0} + '%'" 
									th:aria-valuenow="${ratingCounts != null && ratingCounts.containsKey(i) ? ratingCounts.get(i) : 0}" 
									aria-valuemin="0" 
									th:aria-valuemax="${reviewCount > 0 ? reviewCount : 1}"></div>
							</div>
							<div class="ml-2" style="width: 40px;">
								<span th:text="${ratingCounts != null && ratingCounts.containsKey(i) ? ratingCounts.get(i) : 0}">0</span>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Review Form Section -->
			<div class="row">
				<div class="col-lg-8 offset-lg-2">
					<div th:if="${username != null}" class="review-form bg-light p-4 rounded shadow-sm mb-5">
						<h4 class="mb-3">Viết đánh giá của bạn</h4>
						<form action="#" th:action="@{/products/glasses/{productId}/reviews(productId = ${glasses.id})}" th:method="post">
							<input type="hidden" th:name="productId" name="productId" th:value="${glasses.id}" />
							<input type="hidden" name="username" th:value="${username}" />
							
							<div class="form-group">
								<label for="username">Tên của bạn:</label>
								<input type="text" id="username" class="form-control" th:value="${username}" readonly />
							</div>

							<div class="form-group">
								<label for="rating">Xếp hạng:</label>
								<div class="rating-selector">
									<div class="star-rating">
										<div class="stars d-flex">
											<span class="star" data-rating="1"><i class="bi bi-star"></i></span>
											<span class="star" data-rating="2"><i class="bi bi-star"></i></span>
											<span class="star" data-rating="3"><i class="bi bi-star"></i></span>
											<span class="star" data-rating="4"><i class="bi bi-star"></i></span>
											<span class="star" data-rating="5"><i class="bi bi-star"></i></span>
										</div>
									</div>
									<select id="rating" name="rating" class="form-control d-none" required>
										<option value="" disabled selected>Chọn xếp hạng</option>
										<option th:value="1">1 - Tệ</option>
										<option th:value="2">2 - Kém</option>
										<option th:value="3">3 - Trung bình</option>
										<option th:value="4">4 - Tốt</option>
										<option th:value="5">5 - Tuyệt vời</option>
									</select>
									<div class="rating-text mt-1">Chọn đánh giá</div>
								</div>
							</div>

							<div class="form-group">
								<label for="comment">Bình luận:</label>
								<textarea id="comment" name="content" class="form-control" rows="4" placeholder="Viết nhận xét của bạn..." required></textarea>
							</div>

							<div class="form-group">
								<button type="submit" class="btn btn-primary btn-lg btn-block">Gửi đánh giá</button>
							</div>
						</form>
					</div>
					
					<!-- Login message if user is not logged in -->
					<div th:if="${username == null}" class="alert alert-info text-center p-4 mb-5">
						<i class="bi bi-info-circle-fill mr-2"></i>
						Vui lòng <a th:href="@{/login}" class="font-weight-bold">đăng nhập</a> để viết đánh giá.
					</div>
				</div>
			</div>
			
			<!-- Reviews List Section -->
			<h2 class="display-5 font-weight-bold mb-4">Đánh giá từ khách hàng</h2>
			
			<div th:if="${reviews == null || reviews.empty}" class="text-center p-5 bg-light rounded">
				<i class="bi bi-chat-square-text" style="font-size: 3rem;"></i>
				<p class="mt-3">Chưa có đánh giá nào cho sản phẩm này.</p>
				<p class="text-muted">Hãy là người đầu tiên đánh giá!</p>
			</div>
			
			<div class="reviews-list">
				<div class="review-container" th:each="review : ${reviews}">
					<div class="card my-3 p-4 shadow-sm">
						<div class="d-flex align-items-center mb-2">
							<!-- User Avatar -->
							<div class="mr-3">
								<div class="user-avatar bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" 
									style="width: 50px; height: 50px; font-size: 20px;">
									<span th:text="${#strings.substring(review.username, 0, 1).toUpperCase()}">U</span>
								</div>
							</div>
							
							<!-- User info -->
							<div>
								<strong th:text="${review.username}" class="text-primary d-block" style="font-size: 1.1rem;"></strong>
								<div class="d-flex align-items-center mt-1">
									<!-- Star Rating Display -->
									<div class="stars" style="color: #ffc107;">
										<i th:each="i : ${#numbers.sequence(1, 5)}" 
										   th:class="${i <= review.rating ? 'bi bi-star-fill' : 'bi bi-star'}"
										   style="font-size: 0.9rem;"></i>
									</div>
									
									<!-- Hiển thị thời gian đánh giá theo định dạng người dùng dễ đọc -->
									<span class="ml-2 text-muted" th:if="${review.createdAt != null}">
										<span th:text="${#strings.substring(review.createdAt, 8, 10) + '/' + 
													   #strings.substring(review.createdAt, 5, 7) + '/' + 
													   #strings.substring(review.createdAt, 0, 4) + ' ' + 
													   #strings.substring(review.createdAt, 11, 16)}">
											06/05/2023 00:43
										</span>
									</span>
									<i class="bi bi-patch-check-fill text-success ml-2" title="Verified Purchase"></i>
								</div>
							</div>
						</div>
						
						<!-- Review Content -->
						<div class="mt-3" style="font-size: 1rem; line-height: 1.6;" th:text="${review.content}"></div>
					</div>
				</div>
			</div>

			<!-- Show More Button -->
			<div class="text-center mt-4 mb-5" th:if="${hasMore == true}">
				<button th:attr="data-page = 0, data-product-id = ${glasses.id}"
					class="btn btn-outline-primary px-4 py-2" id="show-more-reviews">
					<i class="bi bi-plus-circle mr-2"></i>Xem thêm đánh giá
				</button>
			</div>
		</div>
		<hr class="mt-5">
		<footer>
			<div class="footer__top section">
				<div class="container">
					<div class="footer__grid row">
						<div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">
							<h3>About Us</h3>
							<p>We are an eyewear store that offers a wide selection of
								fashionable and functional glasses from top brands. Our friendly
								staff are always ready to assist you in finding the perfect pair
								of glasses to match your style and budget. Come visit us and see
								the world in a new light!</p>
						</div>
						<div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">
							<h3>Latest News</h3>
							<div class="footer__link">
								<i class="fa fa-long-arrow-alt-right"></i> <a href="#">Services</a>
							</div>
							<div class="footer__link">
								<i class="fa fa-long-arrow-alt-right"></i> <a href="#">Glasses</a>
							</div>
							<div class="footer__link">
								<i class="fa fa-long-arrow-alt-right"></i> <a href="#">Sunglasses</a>
							</div>
							<div class="footer__link">
								<i class="fa fa-long-arrow-alt-right"></i> <a href="#">Accessories</a>
							</div>
							<div class="footer__link">
								<i class="fa fa-long-arrow-alt-right"></i> <a href="#">Products</a>
							</div>
							<div class="footer__link">
								<i class="fa fa-long-arrow-alt-right"></i> <a href="#">Gift
									Card</a>
							</div>
						</div>
						<div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">
							<h3>Contact Info</h3>
							<div class="footer__contact">
								<i class="fa fa-map-marker-alt"></i> <a href="#">112 Cao
									Thắng, Quận 3 – HCM</a>
							</div>
							<div class="footer__contact">
								<i class="far fa-envelope"></i> <a
									href="mailto:ndat04913@gmail.com">ndat04913@gmail.com</a>
							</div>
							<div class="footer__contact">
								<i class="fas fa-phone-alt"></i> <a href="tel:0966894644">096.689.4644</a>
							</div>
						</div>
					</div>
					<div class="footer__form">
						<form>
							<div class="form-group form-row">
								<label
									class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4 col-form-label"
									for="emailFooter">Sign up for our Newsletter</label>
								<div class="col-8 col-sm-8 col-md-8 col-lg-6 col-xl-6">
									<input type="email" class="form-control" id="emailFooter"
										placeholder="Enter Email Address ...">
								</div>
								<div
									class="col-4 col-sm-4 col-md-4 col-lg-2 col-xl-2 text-center">
									<button type="submit" class="btn">SUBMIT</button>
								</div>

							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="footer__bottom">
				<div>
					© 2024 Instruction. All rights reserved | Design by <a href="#">Nhóm
						10</a>
				</div>
			</div>

		</footer>
		<script th:src="@{/js/jquery.min.js}"></script>
		<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
		<script
			src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
		<script
			src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
		<!--  <script
			src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>-->
		<script th:src="@{/js/detail.js}"></script>
		<script th:src="@{/js/cart.js}"></script>
		<script th:src="@{/js/sweetalert2.all.min.js}"></script>
		
		<!-- Script xử lý hiển thị thông báo lỗi từ errorMessages -->
		<script th:inline="javascript">
			document.addEventListener('DOMContentLoaded', function() {
				// Kiểm tra và hiển thị thông báo lỗi từ errorMessages
				const errorMessages = /*[[${errorMessages}]]*/ null;
				
				// Hiển thị danh sách lỗi nếu có
				if (errorMessages && errorMessages.length > 0) {
					// Tạo HTML cho danh sách lỗi
					let errorHtml = '<ul style="text-align: left; margin: 0; padding-left: 20px;">';
					errorMessages.forEach(function(error) {
						errorHtml += '<li>' + error + '</li>';
					});
					errorHtml += '</ul>';
					
					// Hiển thị SweetAlert2 với danh sách lỗi
					Swal.fire({
						title: 'An error has occurred',
						html: errorHtml,
						icon: 'error',
						confirmButtonText: 'Close',
						confirmButtonColor: '#d33'
					});
				}
			});
		</script>
		
		<script type="text/javascript" th:inline="javascript">
			// Ensure cart quantity display persists
			document.addEventListener('DOMContentLoaded', function() {
				// Kiểm tra xem có thông báo được lưu trong sessionStorage không
				const productAddedInfo = sessionStorage.getItem('productAddedInfo');
				if (productAddedInfo) {
					// Nếu có, hiển thị thông báo và xóa khỏi sessionStorage
					const productInfo = JSON.parse(productAddedInfo);
					showAddToCartSuccessToast(productInfo.name, productInfo.image, productInfo.colorName);
					sessionStorage.removeItem('productAddedInfo');
				}
				
				const cartQuantity = /*[[${cartQuantity}]]*/0;
				const soluongCart = document.querySelector('.soluong_cart');
				if (soluongCart && cartQuantity && cartQuantity > 0) {
					soluongCart.textContent = cartQuantity;
				}
				
				// Hàm hiển thị thông báo thành công
				function showAddToCartSuccessToast(productName, productImage, productColorName) {
					const Toast = Swal.mixin({
						toast: true,
						position: 'top-end',
						showConfirmButton: false,
						timer: 3000,
						timerProgressBar: true,
						didOpen: (toast) => {
							toast.addEventListener('mouseenter', Swal.stopTimer)
							toast.addEventListener('mouseleave', Swal.resumeTimer)
						}
					});
					
					Toast.fire({
						icon: 'success',
						title: `Đã thêm ${productName} vào giỏ hàng!`,
						html: `<div style="display: flex; align-items: center;">
								<img src="${productImage}" style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px;" />
								<div>
									<div>Màu: ${productColorName}</div>
									<div>Số lượng: 1</div>
								</div>
							</div>`,
						customClass: {
							popup: 'swal-wide'
						}
					});
				}
				
				// Xử lý sự kiện thêm vào giỏ hàng
				const addToCartBtn = document.getElementById('add-to-cart-btn');
				const addToCartForm = document.getElementById('add-to-cart-form');
				
				if (addToCartBtn && addToCartForm) {
					console.log('Found add to cart button and form');
					addToCartBtn.addEventListener('click', function() {
						console.log('Add to cart button clicked');
						// Lấy thông tin sản phẩm
						const productElement = document.getElementById('pro_detail');
						const productName = productElement.dataset.name;
						const productImage = productElement.dataset.image;
						const productColorName = productElement.dataset.colorName;
						
						// Gửi form
						const formData = new FormData(addToCartForm);
						
						fetch(addToCartForm.action, {
							method: 'POST',
							body: formData
						})
						.then(response => {
							if (response.ok) {
								console.log('Product added to cart successfully');
								
								// Lưu thông tin sản phẩm vào sessionStorage để hiển thị sau khi tải lại trang
								const productInfo = {
									name: productName,
									image: productImage,
									colorName: productColorName
								};
								sessionStorage.setItem('productAddedInfo', JSON.stringify(productInfo));
								
								// Tải lại trang để cập nhật số lượng giỏ hàng
								window.location.reload();
							} else {
								throw new Error('Có lỗi xảy ra khi thêm sản phẩm vào giỏ hàng');
							}
						})
						.catch(error => {
							console.error('Error:', error);
							Swal.fire({
								icon: 'error',
								title: 'Lỗi!',
								text: error.message,
								confirmButtonColor: '#3085d6'
							});
						});
					});
				} else {
					console.error('Add to cart button or form not found');
				}
			});
		</script>
		
		<style>
		.swal-wide {
			width: 350px !important;
		}
		</style>
</body>
</html>